var amount_reg=/^[0-9]*[1-9][0-9]*$/;function submitCheck(){if($("#transferForm").valid()){var a=$(window).width()/2-64;$.blockUI({message:'<img src="'+ASSETS_URL+'/www/images/009.gif" >',baseZ:2e3,css:{width:"128px",left:a}}),$.ajax({type:"POST",url:CI_URL+"Manger/transfer_do.aspx",cache:!1,dataType:"json",data:$("#transferForm").serialize()}).done(function(a){$.unblockUI(),"Y"==a.RntCode?window.location.reload():"W"==a.RntCode?location.href=location.href:alert(a.Msg)})}}function refresh_balance(){var a=$("#makers_num_A .balance_div").length;for(i=0;i<a;i++){ajax_balance($("#makers_num_A .balance_div").eq(i).attr("data-makersnum"))}}function ajax_balance(a){var e=$("#makers_num_A [data-makersnum="+a+"]"),r=$("#makers_num_A [data-makersnum="+a+"]").html(),n=$("#makers_num_B [data-makersnum="+a+"]"),t=$("#makers_num_B [data-makersnum="+a+"]").html();$.ajax({type:"POST",url:CI_URL+"Manger/ajax_balance.aspx",cache:!1,dataType:"json",data:{makersnum:a}}).done(function(a){$(e).html(r+" ............... "+a.balance),$(n).html(t+" ............... "+a.balance)})}$(function(){refresh_balance(),$(".balance_img").css("cursor","pointer"),$(".balance_img").click(function(a){var e=$(this).parent();ajax_balance($(e).attr("data-makersnum"))}),jQuery.validator.addMethod("amountFormat",function(a,e){return amount_reg.test(a)}),$("#transferForm").validate({onkeyup:!1,errorClass:"alert alert-danger",errorElement:"div",errorPlacement:function(a,e){0<e.parents(".input-group").size()?e.parents(".input-group").after(a):e.parent().append(a)},rules:{makers_num_A:{required:!0},makers_num_B:{required:!0},amount:{required:!0,amountFormat:!0,min:50}},messages:{makers_num_A:{required:"請選擇從哪轉出"},makers_num_B:{required:"請選擇轉入位置"},amount:{required:"請輸入轉移點數",amountFormat:"轉移金額請輸入整數",min:"單筆最少轉移{0}元"}}}),$("#transferBTN").bind("click",submitCheck)});